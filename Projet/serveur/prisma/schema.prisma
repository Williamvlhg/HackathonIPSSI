generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Role {
  id    Int    @id @default(autoincrement())
  label String

  // Un même role peut être attribué à plusieurs utilisateurs
  User User[]
}

model User {
  id Int @id @default(autoincrement())

  firstName String
  lastName  String
  email     String
  password  String

  role   Role @relation(fields: [roleId], references: [id])
  roleId Int

  // Worker peut être null au cas ou si le user à le role RH par exemple
  worker Worker?
}

// Worker est un user qui travail dans un chantier
model Worker {
  id Int @id @default(autoincrement())

  // relation one to one => UN user est peut être UN worker
  user   User @relation(fields: [userId], references: [id])
  userId Int  @unique // @unique veut dire relation one to one

  /**
   * Un worker à un ou plusieurs skills
   * relation one to many
   */
  skills Skill[]

  // le worker peut travailler sur plusieurs sites
  sites Site[] @relation("WorkerSites")
}

model Skill {
  id    Int    @id @default(autoincrement())
  label String

  /**
   * Plusieurs skills peuvent être associés à un worker
   * relation many to one
   */
  worker   Worker? @relation(fields: [workerId], references: [id])
  workerId Int?

  // UN ou PLUSIEURS skills peuvent être associés à un site
  site   Site? @relation(fields: [siteId], references: [id])
  siteId Int?
}

model Site {
  id Int @id @default(autoincrement())

  name      String
  address   String
  startDate String
  endDate   String

  // plusieurs workers sur un site
  workers Worker[] @relation("WorkerSites")

  // un site peut posséder plusieurs skills
  skills Skill[]
}
