generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Worker {
  id     Int     @id @default(autoincrement())
  user   User    @relation(fields: [id], references: [id], onDelete: Cascade)
  skills SkillsOnWorkers[]
}

model Skills {
  id      Int     @id @default(autoincrement())
  label   String
  workers SkillsOnWorkers[]

  site   Site? @relation(fields: [siteId], references: [id])
  siteId Int?
}

model SkillsOnWorkers {
  workerId Int
  skillId  Int

  worker Worker @relation(fields: [workerId], references: [id], onDelete: Cascade)
  skill  Skills @relation(fields: [skillId], references: [id], onDelete: Cascade)

  @@id([workerId, skillId]) // Clé primaire composite pour éviter les doublons
}

model Role {
  id    Int    @id @default(autoincrement())
  label String

  user User[]
}

model User {
  id        Int    @id @default(autoincrement())
  lastName  String
  firstName String
  email     String @unique
  password  String
  role      Role   @relation(fields: [roleId], references: [id])
  roleId    Int

  worker Worker?
}

model Site {
  id      Int    @id @default(autoincrement())
  name    String
  address String

  startDate String
  endDate   String
  skills    Skills[]
}